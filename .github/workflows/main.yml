name: Main

on:
    workflow_dispatch:
    push:
        branches: [ "main" ]

jobs:
    build:
        runs-on: ubuntu-22.04
        steps:
            -   uses: actions/checkout@v4
            -   name: Set up Python
                uses: actions/setup-python@v5
                with:
                    python-version: "3.10"
            -   name: Build
                run: |
                    pip install -U "jupyter-book>=0.11.2"
                    jupyter-book build .
            # https://github.com/actions/upload-pages-artifact
            - name: Upload GitHub Pages artifact
              uses: actions/upload-pages-artifact@v3.0.1        
              with:
                path: _build/html/
    deploy:
      environment:
        name: github-pages
        url: ${{ steps.deployment.outputs.page_url }}
      runs-on: ubuntu-latest
      needs: build
      steps:
            # https://github.com/actions/deploy-pages
            - name: Deploy GitHub Pages site
              uses: actions/deploy-pages@v4.0.5
